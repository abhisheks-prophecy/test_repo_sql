WITH SQLStatement_1 AS (

  SELECT 
    ST_CENTROID_AGG(points) AS st_centroid_agg,
    ST_CENTROID(ST_UNION_AGG(points)) AS centroid_of_union
  
  FROM UNNEST([ST_GEOGPOINT(1, 5), ST_GEOGPOINT(1, 2), ST_GEOGPOINT(1, -1), ST_GEOGPOINT(1, -1)]) AS points

),

test_all_ungrouped_table AS (

  SELECT * 
  
  FROM test_all_ungrouped_table

),

Geo AS (

  SELECT 
    ST_GEOGFROMTEXT('POINT EMPTY'),
    ST_GEOGPOINT(-122, 47),
    ST_GEOGFROMTEXT('LINESTRING(1 2, 3 4)'),
    SAFE.S2_CELLIDFROMPOINT(ST_GEOGFROMTEXT('LINESTRING(1 2, 3 4)')),
    SAFE.S2_CELLIDFROMPOINT(ST_GEOGFROMTEXT('LINESTRING(1 2, 3 4)'), level => 10),
    S2_COVERINGCELLIDS(ST_GEOGPOINT(-122, 47), min_level => 12),
    ST_ANGLE(ST_GEOGPOINT(-122, 47), ST_GEOGPOINT(-122, 49), ST_GEOGPOINT(-120, 47)),
    ST_AREA(ST_GEOGFROMTEXT('POLYGON((-125 48, -124 46, -117 46, -117 49, -125 48))')),
    ST_ASBINARY(ST_GEOGFROMTEXT('POLYGON((-125 48, -124 46, -117 46, -117 49, -125 48))')),
    ST_ASGEOJSON(ST_GEOGFROMTEXT('POLYGON((-125 48, -124 46, -117 46, -117 49, -125 48))')),
    ST_ASTEXT(ST_GEOGFROMTEXT('POLYGON((-125 48, -124 46, -117 46, -117 49, -125 48))')),
    ST_AZIMUTH(ST_GEOGPOINT(-122, 47), ST_GEOGPOINT(-122, 44)),
    ST_BOUNDINGBOX(ST_GEOGFROMTEXT('POLYGON((-125 48, -124 46, -117 46, -117 49, -125 48))')),
    ST_NUMPOINTS(ST_BUFFER(ST_GEOGFROMTEXT('POINT(1 2)'), 50, 2)),
    st_NumPoints(ST_BUFFERWITHTOLERANCE(ST_GEOGFROMTEXT('POINT(100 2)'), 100, 1)),
    ST_CENTROID(ST_GEOGFROMTEXT('POLYGON((-125 48, -124 46, -117 46, -117 49, -125 48))')),
    ST_CENTROID_AGG(ST_GEOGFROMTEXT('POLYGON((-125 48, -124 46, -117 46, -117 49, -125 48))')),
    ST_CLOSESTPOINT(ST_GEOGPOINT(-122, 47), ST_GEOGPOINT(122, 47)),
    ST_CLUSTERDBSCAN(ST_GEOGFROMTEXT('MULTIPOINT(1 1, 2 2, 4 4, 5 2)'), 100000.0, 1) OVER (),
    ST_CONTAINS(ST_GEOGFROMTEXT('POLYGON((1 1, 20 1, 10 20, 1 1))'), ST_GEOGPOINT(0, 0)),
    ST_CONVEXHULL(ST_GEOGFROMTEXT('LINESTRING(1 1, 2 2)')),
    ST_COVEREDBY(ST_GEOGPOINT(-122, 47), ST_GEOGPOINT(122, 47)),
    ST_COVERS(ST_GEOGFROMTEXT('POLYGON((1 1, 20 1, 10 20, 1 1))'), ST_GEOGPOINT(1, 1)),
    ST_DIFFERENCE(ST_GEOGFROMTEXT('POLYGON((0 0, 10 0, 10 10, 0 0))'), ST_GEOGFROMTEXT('POLYGON((4 2, 6 2, 8 6, 4 2))')),
    ST_DIMENSION(ST_GEOGFROMTEXT('POLYGON((0 0, 10 0, 10 10, 0 0))'))
  
  FROM test_all_ungrouped_table AS in0

),

Reformat_1 AS (

  SELECT 
    c_int64 AS c_int64,
    ST_GEOGPOINT(-122, 47) AS c_test
  
  FROM test_all_ungrouped_table AS in0

),

qa_test_table AS (

  SELECT * 
  
  FROM {{ source('prophecy-qa.qa_test_dataset', 'qa_test_table') }}

)

SELECT * 

FROM Reformat_1
