{"id":"env_uitesting_main_model_databricks_2","metainfo":{"label":"env_uitesting_main_model_databricks_2","autoLayout":false,"staleState":"none","sourceSuggestions":{"sources":[]},"graphConfig":{"userDefinedConfig":{"vars":{}}}},"processes":{"raw_orders##YsMlzdpH":{"id":"raw_orders##YsMlzdpH","component":"Seed","metadata":{"label":"raw_orders","x":80,"y":320,"phase":0},"properties":{"table":{"name":"raw_orders","sourceType":"Seed"}},"ports":{"inputs":[],"outputs":[{"id":"HUzncomI","schema":{"providerType":"Databricks","fields":[{"name":"id","dataType":{"type":"Integer"}},{"name":"user_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"5uNjDyty_eoIf4Hc0O7X4":{"id":"5uNjDyty_eoIf4Hc0O7X4","component":"Seed","metadata":{"label":"service_classification","slug":"service_classification","x":-240,"y":160,"phase":0},"properties":{"table":{"name":"service_classification","sourceType":"Seed","alias":""}},"ports":{"inputs":[],"outputs":[{"id":"J3Ok9zPFMDNjpZtbwexMe","schema":{"providerType":"Databricks","fields":[{"name":"code","dataType":{"type":"String"}},{"name":"service_label","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"env_uitesting_main_model_databricks_2##NL4w1wgX":{"id":"env_uitesting_main_model_databricks_2##NL4w1wgX","component":"TargetModel","metadata":{"label":"env_uitesting_main_model_databricks_2","x":320,"y":520,"phase":0,"macroDependencies":["is_incremental"]},"properties":{"customQueryDisabled":true,"customQuery":false,"incrementalEditorDisabled":false,"query":"SELECT * \n\nFROM raw_orders\n\n{% if is_incremental() %}\n  WHERE \n    user_id > (SELECT MAX(user_id) FROM {{ this }})\n{% endif %}","incrementalKey":true,"incremental":{"expression":"user_id"}},"ports":{"inputs":[{"id":"GecJapvR","schema":{"providerType":"Databricks","fields":[{"name":"id","dataType":{"type":"Integer"}},{"name":"user_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"raw_orders"}],"outputs":[{"id":"qOehdF6V","schema":{"providerType":"Databricks","fields":[{"name":"id","dataType":{"type":"Integer"}},{"name":"user_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"BYNZucJpJlrzR-uhsC87C":{"id":"BYNZucJpJlrzR-uhsC87C","component":"Model","metadata":{"label":"model_with_only_seed","slug":"model_with_only_seed","x":-240,"y":0,"phase":0},"properties":{"table":{"name":"model_with_only_seed","sourceType":"Model","alias":""}},"ports":{"inputs":[],"outputs":[{"id":"FqtzmvWEfbwopEMT98KkL","schema":{"providerType":"Databricks","fields":[{"name":"country_code","dataType":{"type":"String"}},{"name":"country_label","dataType":{"type":"String"}},{"name":"code","dataType":{"type":"String"}},{"name":"service_label","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"m8vlyGNLJjPKfUG3cWkj_$$ck90Jy9wxS05tk915fkgX":{"id":"m8vlyGNLJjPKfUG3cWkj_$$ck90Jy9wxS05tk915fkgX","component":"Join","metadata":{"label":"Join_1","slug":"Join_1","x":-40,"y":60,"phase":0,"macroDependencies":[]},"properties":{"conditions":[{"alias":"in1","expression":{"expression":"in0.service_label=in1.service_label"},"joinType":"inner"}],"expressions":[{"expression":{"expression":"in0.country_code"},"alias":"country_code"},{"expression":{"expression":"in0.country_label"},"alias":"country_label"},{"expression":{"expression":"in1.code"},"alias":"code"},{"expression":{"expression":"in0.service_label"},"alias":"service_label"}],"activeTab":"expressions","columnsSelector":["yOGmCJbYWxPuq-cR11o5u$$_mDSSw2hiE51-KnQWvY1v##service_label","lRgkAlCjZAQKn36r1mowS$$wKNZeL5aTDTXsx9_uB28s##service_label","yOGmCJbYWxPuq-cR11o5u$$_mDSSw2hiE51-KnQWvY1v##country_code","yOGmCJbYWxPuq-cR11o5u$$_mDSSw2hiE51-KnQWvY1v##country_label","lRgkAlCjZAQKn36r1mowS$$wKNZeL5aTDTXsx9_uB28s##code","yOGmCJbYWxPuq-cR11o5u$$_mDSSw2hiE51-KnQWvY1v##service_label"],"headAlias":"in0"},"ports":{"inputs":[{"id":"yOGmCJbYWxPuq-cR11o5u$$_mDSSw2hiE51-KnQWvY1v","schema":{"providerType":"Databricks","fields":[{"name":"country_code","dataType":{"type":"String"}},{"name":"country_label","dataType":{"type":"String"}},{"name":"code","dataType":{"type":"String"}},{"name":"service_label","dataType":{"type":"String"}}]},"slug":"in0"},{"id":"lRgkAlCjZAQKn36r1mowS$$wKNZeL5aTDTXsx9_uB28s","schema":{"providerType":"Databricks","fields":[{"name":"code","dataType":{"type":"String"}},{"name":"service_label","dataType":{"type":"String"}}]},"slug":"in1"}],"outputs":[{"id":"CPI0T-gL4dZLf8S4bzJzF$$JzjdyUa_H2HjH4i-4aKRN","schema":{"providerType":"Databricks","fields":[{"name":"country_code","dataType":{"type":"String"}},{"name":"country_label","dataType":{"type":"String"}},{"name":"code","dataType":{"type":"String"}},{"name":"service_label","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"Reformat_1##sTatMCbz":{"id":"Reformat_1##sTatMCbz","component":"Reformat","metadata":{"label":"Reformat_1","x":320,"y":320,"phase":0,"macroDependencies":[]},"properties":{"columnsSelector":[],"expressions":[]},"ports":{"inputs":[{"id":"m6RjxpIZ","schema":{"providerType":"Databricks","fields":[{"name":"id","dataType":{"type":"Integer"}},{"name":"user_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"in0"}],"outputs":[{"id":"MBy7TKud","schema":{"providerType":"Databricks","fields":[{"name":"id","dataType":{"type":"Integer"}},{"name":"user_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}},"SQLStatement_1##YipIN2L7":{"id":"SQLStatement_1##YipIN2L7","component":"Reformat","metadata":{"label":"SQLStatement_1","x":320,"y":120,"phase":0,"macroDependencies":[]},"properties":{"columnsSelector":[],"expressions":[]},"ports":{"inputs":[{"id":"XtPYXrPi","schema":{"providerType":"Databricks","fields":[{"name":"id","dataType":{"type":"Integer"}},{"name":"user_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"raw_orders"}],"outputs":[{"id":"D4MbDcCD","schema":{"providerType":"Databricks","fields":[{"name":"id","dataType":{"type":"Integer"}},{"name":"user_id","dataType":{"type":"Integer"}},{"name":"order_date","dataType":{"type":"Date"}},{"name":"status","dataType":{"type":"String"}}]},"slug":"out"}],"isCustomOutputSchema":false}}},"connections":[{"id":"D8CLRZZV","source":"raw_orders##YsMlzdpH","sourcePort":"HUzncomI","target":"SQLStatement_1##YipIN2L7","targetPort":"XtPYXrPi"},{"id":"FW38kkf0","source":"raw_orders##YsMlzdpH","sourcePort":"HUzncomI","target":"Reformat_1##sTatMCbz","targetPort":"m6RjxpIZ"},{"id":"J1xWPbIP","source":"raw_orders##YsMlzdpH","sourcePort":"HUzncomI","target":"env_uitesting_main_model_databricks_2##NL4w1wgX","targetPort":"GecJapvR"},{"id":"CamGKJpYOk8sUN6By5PKc$$CUv2q-F8mimtb8EpJ2WCE","source":"BYNZucJpJlrzR-uhsC87C","sourcePort":"FqtzmvWEfbwopEMT98KkL","target":"m8vlyGNLJjPKfUG3cWkj_$$ck90Jy9wxS05tk915fkgX","targetPort":"yOGmCJbYWxPuq-cR11o5u$$_mDSSw2hiE51-KnQWvY1v"},{"id":"1nqGYrOombTFuZczT0TrC","source":"5uNjDyty_eoIf4Hc0O7X4","sourcePort":"J3Ok9zPFMDNjpZtbwexMe","target":"m8vlyGNLJjPKfUG3cWkj_$$ck90Jy9wxS05tk915fkgX","targetPort":"lRgkAlCjZAQKn36r1mowS$$wKNZeL5aTDTXsx9_uB28s"}],"component":"Model"}